paths:
  # Tag: Authentication
  /auth/signin:
    post:
      tags:
        - Backend-Server / Authentication
      summary: User Login
      description: Authenticates a user and returns a JWT token.
      operationId: userLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../schemas.yaml#/components/schemas/SignInRequest"
      responses:
        "200":
          description: Successful login
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                  - type: object
                    properties:
                      data:
                        $ref: "../schemas.yaml#/components/schemas/SignInResponse"
        "401":
          description: Unauthorized - Invalid credentials
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
  /auth/signup:
    post:
      tags:
        - Backend-Server / Authentication
      summary: User Registration
      description: Registers a new user and returns a JWT token.
      operationId: userRegistration
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../schemas.yaml#/components/schemas/SignupRequest"
      responses:
        "201":
          description: Successful registration
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                  - type: object
                    properties:
                      data:
                        $ref: "../schemas.yaml#/components/schemas/UserProfileResponse"
        "400":
          description: Bad Request - Invalid input data
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"

  /auth/google/authorize:
    get:
      tags:
        - Backend-Server / Authentication
      summary: Google OAuth2 Authorization
      description: Redirects the user to Google's OAuth2 authorization page.
      operationId: googleOAuth2Authorize
      security: []
      responses:
        "200":
          description: Get link to Google OAuth2 authorization URL
          content:
            application/json:
              schema:
                properties:
                  success:
                    type: boolean
                    example: true
                  code:
                    type: integer
                    example: 200
                  timestamp:
                    type: string
                    format: date-time
                    example: "2025-11-16"
                  message:
                    type: string
                    example: "http://localhost:8082/realms/ai-primary-dev/protocol/openid-connect/auth?scope=openid+profile+email&response_type=code&client_id=ai-primary&redirect_uri=http%3A%2F%2Flocalhost%3A3000&state=4b089761-da3b-4836-8f40-0a86f7536301&kc_idp_hint=google&prompt=login"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
  /auth/exchange:
    post:
      tags:
        - Backend-Server / Authentication
      summary: Google OAuth2 Authorization
      description: Exchange code for user profile information.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: The authorization code received from Google OAuth2
                  example: "4/0AY0e-g7..."
                redirectUri:
                  type: string
                  description: The redirect URI used in the OAuth2 flow
                  example: "http://localhost:3000"
      responses:
        "200":
          description: Get link to Google OAuth2 authorization URL
          content: 
            application/json:
                schema:
                  allOf:
                    - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                    - type: object
                      properties:
                        data:
                          $ref: "../schemas.yaml#/components/schemas/UserProfileResponse"
        "400":
          description: Bad Request - Invalid input data
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"

  # Tag: Me-Management
  /user/me:
    get:
      tags:
        - Backend-Server / Users
      summary: Get Current User Profile
      description: Retrieves the profile information of the currently authenticated user.
      operationId: getCurrentUserProfile
      responses:
        "200":
          description: Successful retrieval of user profile
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                  - type: object
                    properties:
                      data:
                        $ref: "../schemas.yaml#/components/schemas/UserProfileResponse"
        "401":
          description: Unauthorized - Invalid or missing token
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
    patch:
      tags:
        - Backend-Server / Users
      summary: Update Current User Profile
      description: Updates the profile information of the currently authenticated user.
      operationId: updateCurrentUserProfile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "../schemas.yaml#/components/schemas/UserProfileUpdateRequest"
      responses:
        "200":
          description: Successful update of user profile
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                  - type: object
                    properties:
                      data:
                        $ref: "../schemas.yaml#/components/schemas/UserProfileResponse"
        "400":
          description: Bad Request - Invalid input data
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "401":
          description: Unauthorized - Invalid or missing token
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"

  /user/me/avatar:
    patch:
      tags:
        - Backend-Server / Users
      summary: Update Current User Avatar
      description: Updates the profile avatar of the currently authenticated user. Accepts image file upload.
      operationId: updateCurrentUserAvatar
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  format: binary
                  description: Avatar image file (JPG, PNG, GIF). Maximum size 5MB.
              required:
                - avatar
      responses:
        "200":
          description: Avatar updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/responses/AppResponseDto"
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          avatarUrl:
                            type: string
                            format: uri
                            description: URL of the updated avatar image
                            example: "https://cdn.example.com/avatars/user_12345.jpg"
        "400":
          description: Bad Request - Invalid file format or size
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/schemas/Error"
                  - type: object
                    properties:
                      errorCode:
                        type: string
                        example: "INVALID_AVATAR_FILE"
                      message:
                        type: string
                        example: "Avatar must be a valid image file (JPG, PNG, GIF) and less than 5MB"
        "413":
          description: Payload Too Large - File size exceeds limit
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "../schemas.yaml#/components/schemas/Error"
                  - type: object
                    properties:
                      errorCode:
                        type: string
                        example: "FILE_TOO_LARGE"
                      message:
                        type: string
                        example: "Avatar file size must not exceed 5MB"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
    delete:
      tags:
        - Backend-Server / Users
      summary: Remove Current User Avatar
      description: Removes the profile avatar of the currently authenticated user, reverting to the default avatar.
      operationId: removeCurrentUserAvatar
      responses:
        "204":
          description: Avatar removed successfully
        "401":
          description: Unauthorized - Invalid or missing token
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "../schemas.yaml#/components/schemas/Error"